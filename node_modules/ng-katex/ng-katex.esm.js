import{Input as t,Output as e,Component as n,EventEmitter as r,Injectable as o,Directive as i,ElementRef as a,NgModule as p}from"@angular/core";import{extractMath as s}from"extract-math";import{CommonModule as c}from"@angular/common";import{render as u,renderToString as f}from"katex";import{DomSanitizer as g}from"@angular/platform-browser";function l(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var p=t.length-1;p>=0;p--)(o=t[p])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}function m(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}var y=function(){function o(){this.onError=new r}return o.prototype.hasError=function(t){this.onError.emit(t)},l([t(),m("design:type",String)],o.prototype,"equation",void 0),l([t(),m("design:type",Object)],o.prototype,"options",void 0),l([e(),m("design:type",Object)],o.prototype,"onError",void 0),o=l([n({selector:"ng-katex",template:'\n    <span [katex]="equation"\n          [katex-options]="options"\n          (someEvent)="hasError($event)">\n    </span>\n  '})],o)}(),d=function(){function e(){}return Object.defineProperty(e.prototype,"segments",{get:function(){return s(this.paragraph)},enumerable:!0,configurable:!0}),l([t(),m("design:type",String)],e.prototype,"paragraph",void 0),e=l([n({selector:"ng-katex-paragraph",template:'\n    <p>\n      <ng-container *ngFor="let segment of segments">\n        <ng-katex\n          *ngIf="segment.math else text"\n          [equation]="segment.raw"\n          [options]="{ displayMode: segment.type === \'display\' }">\n        </ng-katex>\n        <ng-template #text>{{ segment.value }}</ng-template>\n      </ng-container>\n    </p>\n  '})],e)}(),h=function(){function t(){}return t.prototype.render=function(t,e,n){return u(t,e.nativeElement,n)},t.prototype.renderToString=function(t,e){return f(t,e)},t=l([o()],t)}(),v=function(){function n(t,e){this.el=t,this.katexService=e,this.onError=new r}return n.prototype.ngOnChanges=function(){try{this.katexService.render(this.equation,this.el,this.options)}catch(t){this.onError.emit(t)}},l([t("katex"),m("design:type",String)],n.prototype,"equation",void 0),l([t("katex-options"),m("design:type",Object)],n.prototype,"options",void 0),l([e(),m("design:type",Object)],n.prototype,"onError",void 0),n=l([i({selector:"[katex]"}),m("design:paramtypes",[a,h])],n)}(),x=function(){function e(t,e){this.domSanitizer=t,this.katexService=e}return Object.defineProperty(e.prototype,"allHtml",{get:function(){var t=this,e=this.segments.map(function(e){return e.math?t.katexService.renderToString(e.raw,{displayMode:"display"===e.type}):e.value}).reduce(function(t,e){return t+e});return this.domSanitizer.bypassSecurityTrustHtml(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segments",{get:function(){return s(this.html)},enumerable:!0,configurable:!0}),l([t(),m("design:type",String)],e.prototype,"html",void 0),e=l([n({selector:"ng-katex-html",template:'<span [innerHTML]="allHtml"></span>'}),m("design:paramtypes",[g,h])],e)}(),b=function(){function t(){}return t=l([p({imports:[c],providers:[h],declarations:[v,y,d,x],exports:[y,d,x]})],t)}();export{y as KatexComponent,b as KatexModule,d as KatexParagraphComponent};
